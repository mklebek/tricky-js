<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Tricky JS</title>

		<link rel="stylesheet" href="css/reset.css">
		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/monokai.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<h4>What will the console print out?</h4>
					<pre>Question:<code data-trim>
							[] + []
						</code></pre>
					<pre class="fragment">Result:<code data-trim>
							""
						</code></pre>
					<pre class="fragment">First it calls the abstract ToPrimitive method which in this case results
in stringifying the arrays<code data-trim>
						String([]) + String([])
					</code></pre>
					<pre class="fragment"><code data-trim>
						"" + ""
					</code></pre>
				</section>
				<section>
					<h4>What will the console print out?</h4>
					<pre>Question:<code data-trim>
							{} + []
						</code></pre>
					<pre class="fragment">Result:<code data-trim>
							0
						</code></pre>
					<pre class="fragment">The engine treats the {} as an empty block which leaves us with<code data-trim>
						+[]
					</code></pre>
					<pre class="fragment">+[] is essentialy a shorter way of writing<code data-trim>
						Number([])
					</code></pre>
					<pre class="fragment">Since array is a non primitive type it needs to be converted to primitive first<code data-trim>
						Number("")
					</code></pre>
					<pre class="fragment">And everyone knows that empty string converts to 0 :D<code data-trim>
						0
					</code></pre>
				</section>
				<section>
					<h4>What will the console print out?</h4>
					<pre>Question:<code data-trim>
							[] + {}
						</code></pre>
					<pre class="fragment">Result:<code data-trim>
							"[object Object]"
						</code></pre>
					<pre class="fragment">So in this scenario we are "adding" an array and an object.
We already know array coerces to empty string<code data-trim>
						"" + String({})
					</code></pre>
					<pre class="fragment">Stringified object results in "[object Object]"<code data-trim>
						"" + "[object Object]"
					</code></pre>
					<pre class="fragment">When we concate those two strings we finally end up with<code data-trim>
						"[object Object]"
					</code></pre>
				</section>
				<section>
					<h4>What will the console print out?</h4>
					<pre><code data-trim>
							let testArray = [1, 2, 3] + [4, 5, 6];
						</code></pre>
					<div class="fragment">
					<pre><code data-trim>
							"1,2,34,5,6"
						</code></pre>
					<p>"+" operates on strings (concatenate) or numbers (addition). Since array is not on any of those types it first tries to convert it first.</p>
					</div>
				</section>
				<section>
					<h4>What will the console print out?</h4>
					<pre><code data-trim>
							[] == ![]
						</code></pre>
					<pre class="fragment"><code data-trim>
							[] == ![] // true
						</code></pre>
				</section>
				<section>
					<h4>But why?</h4>
					<pre>First it does the negation, array is not on falsy list<code data-trim>
							[] == false
						</code></pre>
					<pre class="fragment">Coercion prefers numeric comparisons<code data-trim>
							[] == 0
						</code></pre>
					<pre class="fragment">Need to call ToPrimitive on non primitive type<code data-trim>
							"" == 0
						</code></pre>
					<pre class="fragment">Finally it needs to make sure types do match<code data-trim>
							0 == 0
						</code></pre>
				</section>
			</div>
		</div>

		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true }
				]
			});
		</script>
	</body>
</html>
